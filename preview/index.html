<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ClawPunks Art Preview — 20×20 Grid</title>
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: system-ui, sans-serif;
      background: #1a1a2e;
      color: #eee;
      margin: 0;
      padding: 1.5rem;
      min-height: 100vh;
    }
    h1 { margin: 0 0 1rem; font-size: 1.25rem; }
    .layout {
      display: flex;
      gap: 2rem;
      flex-wrap: wrap;
      align-items: flex-start;
    }
    .preview {
      flex: 0 0 auto;
      background: #16213e;
      border-radius: 12px;
      padding: 1rem;
      box-shadow: 0 4px 20px rgba(0,0,0,0.3);
    }
    .preview svg {
      display: block;
      border-radius: 8px;
      image-rendering: pixelated;
      image-rendering: crisp-edges;
    }
    .controls {
      flex: 1;
      min-width: 220px;
    }
    .control-group {
      margin-bottom: 1rem;
    }
    .control-group label {
      display: block;
      font-size: 0.75rem;
      color: #aaa;
      margin-bottom: 0.25rem;
    }
    .color-swatches {
      display: flex;
      gap: 0.35rem;
      flex-wrap: wrap;
    }
    .color-swatch {
      width: 28px;
      height: 28px;
      border-radius: 6px;
      border: 2px solid rgba(255,255,255,0.2);
      cursor: pointer;
    }
    .color-swatch:hover { border-color: #888; }
    .color-swatch.selected { border-color: #fff; box-shadow: 0 0 0 1px #333; }
    .info { font-size: 0.75rem; color: #666; margin-top: 1rem; }
    .scale-info { font-size: 0.7rem; color: #555; margin-top: 0.5rem; }
  </style>
</head>
<body>
  <h1>ClawPunks Art Preview — 20×20 Grid</h1>
  <p class="info">Same layout as generate_grid_svg.py. Body, torso, claw can share a color or differ. 7 colors each.</p>

  <div class="layout">
    <div class="preview">
      <div id="svg-container"></div>
      <p class="scale-info">20×20 → 400×400 px</p>
    </div>
    <div class="controls">
      <div class="control-group" data-trait="bg">
        <label>Background</label>
        <div class="color-swatches" id="bgSwatches"></div>
      </div>
      <div class="control-group" data-trait="body">
        <label>Body</label>
        <div class="color-swatches" id="bodySwatches"></div>
      </div>
      <div class="control-group" data-trait="torso">
        <label>Torso</label>
        <div class="color-swatches" id="torsoSwatches"></div>
      </div>
      <div class="control-group" data-trait="claw">
        <label>Claw</label>
        <div class="color-swatches" id="clawSwatches"></div>
      </div>
      <div class="control-group" data-trait="eyes">
        <label>Eyes</label>
        <div class="color-swatches" id="eyesSwatches"></div>
      </div>
    </div>
  </div>

  <script>
    // 7 colors only: black, white, red, yellow, teal, blue, violet
    const PALETTE = [
      { name: "Black", hex: "#000000" },
      { name: "White", hex: "#ffffff" },
      { name: "Red", hex: "#e53935" },
      { name: "Yellow", hex: "#ffeb3b" },
      { name: "Teal", hex: "#00897b" },
      { name: "Blue", hex: "#2196f3" },
      { name: "Violet", hex: "#8e24aa" },
    ];

    // 20×20 pixel map from generate_grid_svg.py
    // 0=bg, 1=claw, 2=eyes, 3=torso, 4=body (each can have same or different colors)
    const PIXEL_MAP = [
      "00000000000000000000",
      "00000000000000000000",
      "01000000000000000010",
      "01100000044000000110",
      "01101000244200010110",
      "01111004444440011110",
      "01111144444444111110",
      "00111044444444011100",
      "00000044444444000000",
      "00000000433400000000",
      "00000000433400000000",
      "00000000433400000000",
      "00000000433400000000",
      "00000000433400000000",
      "00000004444440000000",
      "00000044444444000000",
      "00000004444440000000",
      "00000000444400000000",
      "00000000044000000000",
      "00000000000000000000",
    ];

    // Default selection: indices into PALETTE (0-6)
    let selected = { bg: 1, body: 2, torso: 2, claw: 2, eyes: 3 };

    const W = 20, H = 20, PIXEL = 20;

    function createSwatches(traitId) {
      const container = document.getElementById(traitId + "Swatches");
      container.innerHTML = "";
      PALETTE.forEach((col, i) => {
        const swatch = document.createElement("div");
        swatch.className = "color-swatch" + (selected[traitId] === i ? " selected" : "");
        swatch.style.background = col.hex;
        swatch.title = col.name;
        swatch.dataset.index = i;
        swatch.addEventListener("click", () => {
          selected[traitId] = i;
          container.querySelectorAll(".color-swatch").forEach((s, j) => s.classList.toggle("selected", j === i));
          render();
        });
        container.appendChild(swatch);
      });
    }

    function buildSVG(bg, body, torso, claw, eyes) {
      const colors = [bg, claw, eyes, torso, body]; // 0=bg, 1=claw, 2=eyes, 3=torso, 4=body
      let rects = "";
      for (let y = 0; y < H; y++) {
        for (let x = 0; x < W; x++) {
          const c = parseInt(PIXEL_MAP[y][x], 10);
          const fill = colors[c];
          const px = x * PIXEL;
          const py = y * PIXEL;
          rects += `<rect x="${px}" y="${py}" width="${PIXEL}" height="${PIXEL}" fill="${fill}" stroke="#cccccc" stroke-width="0.5"/>`;
        }
      }
      const size = W * PIXEL;
      return `<svg xmlns="http://www.w3.org/2000/svg" width="${size}" height="${size}" viewBox="0 0 ${size} ${size}" shape-rendering="crispEdges">
  <rect width="100%" height="100%" fill="${bg}"/>
  ${rects}
</svg>`;
    }

    function render() {
      const bg = PALETTE[selected.bg].hex;
      const body = PALETTE[selected.body].hex;
      const torso = PALETTE[selected.torso].hex;
      const claw = PALETTE[selected.claw].hex;
      const eyes = PALETTE[selected.eyes].hex;
      document.getElementById("svg-container").innerHTML = buildSVG(bg, body, torso, claw, eyes);
    }

    ["bg", "body", "torso", "claw", "eyes"].forEach(createSwatches);
    render();
  </script>
</body>
</html>
